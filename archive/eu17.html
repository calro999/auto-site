<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAL-INTEL | v2 VIBE_CHECK</title>
    <style>
        :root { 
            --bg: #F8F9FA; --text: #1A202C; --accent-pink: #FF0080; --accent-blue: #7928CA; 
            --card-bg: #FFFFFF; --border: #E2E8F0; --glass: rgba(255, 255, 255, 0.9);
        }

        * { box-sizing: border-box; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        body { 
            background: var(--bg); color: var(--text); font-family: 'Helvetica Neue', sans-serif; 
            margin: 0; padding: 0; overflow-x: hidden;
        }

        /* èƒŒæ™¯ã‚¢ãƒ‹ãƒ¡ï¼šå¾©æ´» */
        #connect-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.8; }

        .layout { 
            display: grid; grid-template-columns: 280px 1fr 280px; gap: 30px; 
            max-width: 1500px; margin: 0 auto; padding: 30px;
        }

        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar { position: sticky; top: 30px; height: calc(100vh - 60px); display: flex; flex-direction: column; gap: 20px; }
        .glass-box { 
            background: var(--glass); backdrop-filter: blur(15px); border-radius: 25px; 
            padding: 25px; border: 1px solid var(--border); box-shadow: 0 10px 30px rgba(0,0,0,0.03);
        }
        .box-title { font-size: 0.75rem; font-weight: 900; color: #A0AEC0; letter-spacing: 2px; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }

        /* ãƒ¡ã‚¤ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ */
        header { text-align: center; margin-bottom: 40px; }
        .hero-title { 
            font-size: 4rem; font-weight: 900; margin: 0; letter-spacing: -3px;
            background: linear-gradient(135deg, var(--accent-pink), var(--accent-blue));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        /* 3Dã‚«ãƒ¼ãƒ‰ï¼šå®Œå…¨å¾©å…ƒ */
        .trend-card-container { perspective: 2000px; margin-bottom: 30px; width: 100%; min-height: 550px; }
        .trend-card-inner { 
            position: relative; width: 100%; height: 100%; min-height: 550px;
            transform-style: preserve-3d; transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .trend-card-container.flipped .trend-card-inner { transform: rotateY(180deg); }

        .front, .back { 
            position: absolute; inset: 0; backface-visibility: hidden; 
            background: var(--card-bg); border-radius: 40px; padding: 45px; 
            border: 1px solid var(--border); box-shadow: 0 20px 40px rgba(0,0,0,0.04);
            display: flex; flex-direction: column;
        }
        .back { transform: rotateY(180deg); background: #fafafa; overflow-y: auto; }

        /* ã‚¤ã‚³ãƒ©ã‚¤ã‚¶ãƒ¼ï¼šãƒªãƒƒãƒç‰ˆå¾©æ´» */
        .eq-container { display: flex; gap: 5px; height: 50px; align-items: flex-end; margin-bottom: 25px; }
        .eq-bar { 
            width: 7px; border-radius: 10px; 
            background: linear-gradient(to top, var(--accent-blue), var(--accent-pink));
            animation: eq-wave 0.6s infinite alternate ease-in-out;
        }

        @keyframes eq-wave { from { height: 10%; } to { height: 100%; } }

        /* è£…é£¾ */
        .vibes-memo { 
            background: #F7FAFC; border-left: 8px solid var(--accent-pink); padding: 20px 25px;
            border-radius: 15px; font-weight: 800; font-size: 1.2rem; font-style: italic; margin-bottom: 25px;
        }

        .ai-image-wrap { 
            width: 100%; height: 250px; background: #000; border-radius: 25px; 
            margin-bottom: 20px; display: flex; align-items: center; justify-content: center; overflow: hidden;
        }
        .ai-image-wrap img { width: 100%; height: 100%; object-fit: contain; }

        /* ãƒœã‚¿ãƒ³ */
        .btn-group { display: flex; gap: 15px; margin-top: auto; }
        .btn { 
            padding: 16px 28px; border-radius: 18px; font-weight: 900; text-decoration: none;
            display: inline-flex; align-items: center; justify-content: center; gap: 10px; cursor: pointer; border: none; flex: 1;
        }
        .btn-pink { background: var(--accent-pink); color: white; box-shadow: 0 10px 20px rgba(255,0,128,0.2); }
        .btn-dark { background: var(--text); color: white; }

        /* ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œï¼šãƒã‚°ä¿®æ­£ç‰ˆ */
        @media (max-width: 1100px) {
            .layout { grid-template-columns: 1fr; padding: 15px; }
            .sidebar { display: none; }
            .hero-title { font-size: 2.8rem; }
            .trend-card-container { min-height: 650px; }
            .front, .back { padding: 30px; }
        }
    </style>
</head>
<body>
    <canvas id="connect-bg"></canvas>
    <div class="layout">
        <aside class="sidebar">
            <div class="glass-box">
                <div class="box-title">ğŸ”¥ HOT_TAGS</div>
                <div id="word-ranking" style="display:flex; flex-wrap:wrap; gap:8px;"></div>
            </div>
            <div class="glass-box">
                <div class="box-title">ğŸ“– VIBE_DICTIONARY</div>
                <div id="vibes-dict"></div>
            </div>
        </aside>

        <main>
            <header>
                <h1 class="hero-title">GAL-INTEL</h1>
                <p style="font-weight:900; color:var(--accent-blue); letter-spacing:5px;">AI-SEARCH_ENGINE_OPTIMIZED</p>
            </header>
            <div id="trend-list"></div>
        </main>

        <aside class="sidebar">
            <div class="glass-box">
                <div class="box-title">ğŸ”„ SYNC_STATUS</div>
                <div id="sync-info" style="font-weight:900; font-size:0.9rem;"></div>
            </div>
            <div class="glass-box">
                <div class="box-title">ğŸ’€ GRAVEYARD</div>
                <div id="grave-list"></div>
            </div>
        </aside>
    </div>

    <script>
        const canvas = document.getElementById('connect-bg');
        const ctx = canvas.getContext('2d');
        const DB_URL = '../intelligence_db.json';
        let dots = [];

        function initBg(tags) {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            dots = (tags || []).map(t => ({
                x: Math.random() * canvas.width, y: Math.random() * canvas.height, 
                text: '#' + t, vx: (Math.random() - 0.5) * 0.5, vy: (Math.random() - 0.5) * 0.5
            }));
            animate();
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            dots.forEach(d => {
                d.x += d.vx; d.y += d.vy;
                if (d.x < 0 || d.x > canvas.width) d.vx *= -1; 
                if (d.y < 0 || d.y > canvas.height) d.vy *= -1;
                ctx.font = 'bold 14px Arial'; ctx.fillStyle = 'rgba(121, 40, 202, 0.2)';
                ctx.fillText(d.text, d.x, d.y);
            });
            requestAnimationFrame(animate);
        }

        async function load() {
            const res = await fetch(DB_URL + '?t=' + Date.now());
            const db = await res.json();
            document.getElementById('sync-info').innerText = 'LAST_UPDATE: ' + db.lastUpdate;
            initBg(db.tags);

            document.getElementById('word-ranking').innerHTML = (db.tags || []).map(t => `<span style="background:#edf2f7; padding:6px 12px; border-radius:12px; font-size:0.75rem; font-weight:700;">#${t}</span>`).join('');
            document.getElementById('grave-list').innerHTML = (db.graveyard || []).map(g => `<div style="font-size:0.8rem; border-bottom:1px solid #f0f0f0; padding:8px 0; color:#718096;">âš¡ï¸ ${g.title.substring(0,25)}...</div>`).join('');
            
            document.getElementById('trend-list').innerHTML = (db.current || []).map((t, idx) => {
                const eqBars = Array.from({length: 12}, (_, i) => `<div class="eq-bar" style="animation-delay:${i*0.05}s; height:${10+Math.random()*90}%"></div>`).join('');
                return `
                <div class="trend-card-container" id="c-${idx}">
                    <div class="trend-card-inner">
                        <div class="front">
                            <div class="vibes-memo">â€œ ${t.memo} â€</div>
                            <div class="eq-container">${eqBars}</div>
                            <h2 style="font-size:1.8rem; font-weight:900; margin:0 0 15px 0; line-height:1.2;">${t.title}</h2>
                            <p style="color:#4A5568; font-size:1rem; flex-grow:1; line-height:1.6;">${t.desc}</p>
                            <div class="btn-group">
                                <div class="btn btn-pink" onclick="document.getElementById('c-${idx}').classList.toggle('flipped')">ğŸ”„ è£é¢ã‚’ãƒã‚§ãƒƒã‚¯</div>
                            </div>
                        </div>
                        <div class="back">
                            <div class="ai-image-wrap"><img src="${t.aiImage}"></div>
                            <div style="background:#fff; border:1px solid #eee; padding:20px; border-radius:20px; margin-bottom:20px; box-shadow:inset 0 2px 4px rgba(0,0,0,0.02);">
                                <strong style="color:var(--accent-pink); font-size:0.8rem;">AI_INSIGHT:</strong><br>
                                <p style="font-size:0.95rem; color:#2D3748; margin:5px 0 0 0; font-weight:600;">${t.aiSummary}</p>
                            </div>
                            <div class="btn-group">
                                <a href="archive/${t.slug}.html" class="btn btn-pink">ğŸ“– ç‰¹è¨­ãƒšãƒ¼ã‚¸</a>
                                <div class="btn btn-dark" onclick="document.getElementById('c-${idx}').classList.toggle('flipped')">ğŸ”™ æˆ»ã‚‹</div>
                            </div>
                        </div>
                    </div>
                </div>`;
            }).join('');
        }
        load();
        window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });
    </script>
</body>
</html>