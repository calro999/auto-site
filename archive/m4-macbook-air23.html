<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAL-INTEL // Realtime Intelligence Feed</title>
    <style>
        :root {
            --bg-main: linear-gradient(135deg, #ffffff 0%, #fff5f7 100%);
            --accent-pink: #ff8fc5;
            --accent-blue: #00d1df;
            --accent-purple: #b070ff;
            --glass: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(0, 0, 0, 0.08);
            --text-main: #2d3436;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        
        body { 
            background: var(--bg-main);
            background-attachment: fixed;
            color: var(--text-main); 
            overflow-x: hidden; 
            min-height: 100vh;
        }

        /* ËÉåÊôØÊºîÂá∫Áî®„Ç≠„É£„É≥„Éê„ÇπÔºö„Éè„ÉÉ„Ç∑„É•„Çø„Ç∞„ÅÆËâ≤„Çí„Åï„Çâ„Å´ÊøÉ„ÅèË®≠ÂÆö */
        #connect-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; opacity: 0.8; 
        }

        .layout { 
            display: grid; 
            grid-template-columns: 320px 1fr 320px; 
            gap: 20px; 
            padding: 20px; 
            max-width: 1800px; 
            margin: 0 auto; 
        }

        .sidebar { height: calc(100vh - 40px); position: sticky; top: 20px; }
        .scroll-area { height: 100%; overflow-y: auto; padding-right: 10px; }
        .scroll-area::-webkit-scrollbar { width: 4px; }
        .scroll-area::-webkit-scrollbar-thumb { background: var(--glass-border); border-radius: 10px; }

        .glass-box {
            background: var(--glass); backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border); border-radius: 16px;
            padding: 20px; margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.03);
        }

        .box-title { font-size: 0.75rem; font-weight: 900; letter-spacing: 0.2em; color: var(--accent-pink); margin-bottom: 15px; border-left: 3px solid var(--accent-pink); padding-left: 10px; }

        header { text-align: center; margin-bottom: 40px; }
        .hero-title { 
            font-size: 4rem; font-weight: 900; letter-spacing: -0.05em; 
            background: linear-gradient(to bottom, #333, #888); 
            -webkit-background-clip: text; 
            background-clip: text;
            -webkit-text-fill-color: transparent; 
        }
        .hero-subtitle { color: var(--accent-blue); font-family: monospace; letter-spacing: 0.3em; font-weight: bold; }

        .main-feed { display: flex; flex-direction: column; gap: 30px; }

        /* Card System */
        .trend-card-container { perspective: 1500px; height: 500px; }
        .trend-card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1); transform-style: preserve-3d; }
        .trend-card-container.flipped .trend-card-inner { transform: rotateY(180deg); }

        .front, .back {
            position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
            border-radius: 24px; border: 1px solid var(--glass-border); padding: 30px;
            display: flex; flex-direction: column; overflow: hidden;
        }

        .front { background: rgba(255, 255, 255, 0.9); box-shadow: 0 10px 40px rgba(0,0,0,0.05); }
        .back { background: linear-gradient(135deg, #fff5f7 0%, #fff 100%); transform: rotateY(180deg); }

        .vibes-memo { 
            font-style: italic; color: #444; font-size: 1.1rem; margin-bottom: 20px; 
            background: linear-gradient(90deg, rgba(255, 143, 197, 0.2) 0%, rgba(201, 148, 255, 0.1) 100%); 
            padding: 12px 18px; border-radius: 8px; border-left: 4px solid var(--accent-pink);
        }

        .trend-title { font-size: 2.5rem; font-weight: 900; margin-bottom: 10px; line-height: 1.1; color: #111; }
        .trend-desc { color: #555; line-height: 1.6; margin-bottom: 20px; flex-grow: 1; }

        .eq-container { display: flex; align-items: flex-end; gap: 3px; height: 60px; margin-bottom: 30px; }
        .eq-bar { flex: 1; background: var(--accent-purple); animation: eq 0.6s infinite alternate ease-in-out; }
        @keyframes eq { from { height: 10%; opacity: 0.3; } to { height: 100%; opacity: 0.8; } }

        .ai-image-wrap { width: 100%; height: 220px; border-radius: 12px; overflow: hidden; margin-bottom: 20px; border: 1px solid var(--glass-border); }
        .ai-image-wrap img { width: 100%; height: 100%; object-fit: cover; }
        .summary-box { background: rgba(255,255,255,0.5); border-radius: 12px; padding: 20px; flex-grow: 1; border-left: 2px solid var(--accent-blue); }
        .summary-label { font-size: 0.7rem; color: var(--accent-blue); margin-bottom: 8px; font-weight: 800; }
        .summary-text { font-size: 0.95rem; line-height: 1.7; color: #444; }

        .btn-group { display: flex; gap: 10px; flex-wrap: wrap; }
        .btn { padding: 12px 24px; border-radius: 12px; font-weight: 800; cursor: pointer; transition: 0.3s; text-decoration: none; display: inline-block; text-align: center; font-size: 0.9rem; }
        .btn-pink { background: var(--accent-pink); color: white; }
        .btn-amazon { background: #ff9900; color: white; }
        .btn-outline { border: 1px solid var(--glass-border); color: #666; background: #fff; }
        .btn-dark { background: #333; color: white; }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }

        .tag-item { background: rgba(255,0,122,0.05); color: var(--accent-pink); padding: 4px 10px; border-radius: 6px; font-size: 0.8rem; font-weight: bold; border: 1px solid rgba(255,0,122,0.1); }
        .grave-item { display: block; padding: 10px; color: #718096; text-decoration: none; font-size: 0.85rem; border-radius: 8px; transition: 0.2s; }
        .grave-item:hover { background: rgba(0,0,0,0.02); color: var(--accent-pink); }

        /* „É¢„Éê„Ç§„É´„É¨„Ç§„Ç¢„Ç¶„Éà‰øÆÊ≠£ÔºöÊñáÂ≠ó„Çµ„Ç§„Ç∫„Ç¢„ÉÉ„Éó & Êû†ÔºàpaddingÔºâ„ÇíÁ∏ÆÂ∞è */
        @media (max-width: 1200px) {
            .layout { grid-template-columns: 1fr; padding: 10px; } /* ‰ΩôÁôΩÂâäÊ∏õ */
            .sidebar { display: none; }
            header { margin-bottom: 20px; }
            .hero-title { font-size: 2.8rem; } 
            .hero-subtitle { font-size: 0.9rem; }
            
            .trend-card-container { height: auto; min-height: 620px; margin-bottom: 15px; }
            .front, .back { 
                position: relative; width: 100%; height: auto; min-height: 620px; 
                padding: 15px; /* Êû†„ÇíÂ∞è„Åï„Åè */
                border-radius: 16px; 
            }
            .back { position: absolute; top: 0; left: 0; height: 100%; }
            
            .trend-title { font-size: 2.0rem; } /* ÊñáÂ≠ó„ÇíÂ§ß„Åç„Åè */
            .trend-desc { font-size: 1.05rem; } /* ÊñáÂ≠ó„ÇíÂ§ß„Åç„Åè */
            .vibes-memo { font-size: 1.1rem; padding: 10px; } /* ÊñáÂ≠ó„ÇíÂ§ß„Åç„Åè */
            .summary-text { font-size: 1.0rem; } /* ÊñáÂ≠ó„ÇíÂ§ß„Åç„Åè */
            
            .btn-group { flex-direction: column; gap: 8px; }
            .btn { width: 100%; padding: 14px; font-size: 1.0rem; }
        }

        @media (max-width: 480px) {
            .hero-title { font-size: 2.4rem; }
            .trend-title { font-size: 1.8rem; }
        }
    </style>
</head>
<body>

    <canvas id="connect-bg"></canvas>

    <div class="layout">
        <aside class="sidebar">
            <div class="scroll-area">
                <div class="glass-box">
                    <div class="box-title">HOT_TAGS</div>
                    <div id="word-ranking" style="display:flex; flex-wrap:wrap; gap:12px;"></div>
                </div>
                <div class="glass-box">
                    <div class="box-title">VIBES_DICT</div>
                    <div id="vibes-dict"></div>
                </div>
            </div>
        </aside>

        <main>
            <header>
                <h1 class="hero-title">GAL-INTEL</h1>
                <div class="hero-subtitle">v2 / Realtime Intelligence Feed</div>
            </header>
            <div class="main-feed" id="trend-list"></div>
        </main>

        <aside class="sidebar">
            <div class="scroll-area">
                <div class="glass-box">
                    <div class="box-title">SYNC_STATUS</div>
                    <div id="sync-info" style="font-weight: 900; color: var(--accent-blue);"></div>
                    <div id="archive-links" style="margin-top:25px; display:flex; flex-direction:column; gap:12px;"></div>
                </div>
                <div class="glass-box">
                    <div class="box-title">GRAVEYARD</div>
                    <div id="grave-list"></div>
                </div>
            </div>
        </aside>
    </div>

    <script>
        const canvas = document.getElementById('connect-bg');
        const ctx = canvas.getContext('2d');
        const DB_URL = '../intelligence_db.json';
        let dots = [];

        function initBg(tags) {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            dots = (tags || []).map(t => ({
                x: Math.random() * canvas.width, 
                y: Math.random() * canvas.height, 
                text: '#' + t, 
                vx: (Math.random() - 0.5) * 1.5, 
                vy: (Math.random() - 0.5) * 1.5, 
                size: Math.random() * 8 + 16
            }));
            animate();
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            dots.forEach(d => {
                d.x += d.vx; d.y += d.vy;
                if (d.x < 0 || d.x > canvas.width) d.vx *= -1; 
                if (d.y < 0 || d.y > canvas.height) d.vy *= -1;
                ctx.font = `bold ${d.size}px Arial`; 
                // Ëâ≤„ÅÆÊøÉÂ∫¶„Çí„Åï„Çâ„Å´„Ç¢„ÉÉ„Éó (‰∏çÈÄèÊòéÂ∫¶ 0.7)
                ctx.fillStyle = 'rgba(255, 143, 197, 0.7)';
                ctx.fillText(d.text, d.x, d.y);
            });
            requestAnimationFrame(animate);
        }

        async function load() {
            try {
                const res = await fetch(DB_URL + '?t=' + Date.now());
                const db = await res.json();
                document.getElementById('sync-info').innerText = 'UPDT: ' + db.lastUpdate;
                initBg(db.tags);

                document.getElementById('word-ranking').innerHTML = (db.tags || []).map(t => `<span class="tag-item">#${t}</span>`).join('');
                document.getElementById('vibes-dict').innerHTML = (db.dictionary || []).map(d => `<div class="dict-item"><span style="display:block; color:var(--accent-blue); font-weight:900; font-size:1.1rem;">${d.word}</span><span style="color:#718096; font-size:0.9rem;">${d.mean}</span></div>`).join('');
                
                document.getElementById('grave-list').innerHTML = (db.graveyard || []).slice(0, 10).map(g => {
                    const link = g.slug ? `archive/${g.slug}.html` : `archive/${g.title}.html`;
                    return `<a href="${link}" class="grave-item">‚ö°Ô∏è ${g.title.substring(0,30)}...</a>`;
                }).join('');

                document.getElementById('archive-links').innerHTML = (db.archiveList || []).slice(0,5).map(a => `<a href="archive/${a}.html" class="btn btn-outline" style="font-size:0.85rem; padding:12px;">üìÖ ${a} Archive</a>`).join('');

                document.getElementById('trend-list').innerHTML = (db.current || []).map((t, idx) => {
                    let bars = '';
                    for(let i=0; i<15; i++) {
                        bars += `<div class="eq-bar" style="animation-delay: ${i * 0.05}s; height: ${Math.random() * 80 + 20}%"></div>`;
                    }
                    return `
                        <div class="trend-card-container" id="card-${idx}">
                            <div class="trend-card-inner">
                                <div class="front">
                                    <div class="vibes-memo">‚Äú ${t.memo} ‚Äù</div>
                                    <div class="eq-container">
                                        ${bars}
                                    </div>
                                    <h2 class="trend-title">${t.title}</h2>
                                    <p class="trend-desc">${t.desc}</p>
                                    <div class="btn-group">
                                        <a href="archive/${t.slug}.html" class="btn btn-pink">üìñ DETAILS (ÁâπË®≠)</a>
                                        <a href="https://www.amazon.co.jp/s?k=${encodeURIComponent(t.title)}&tag=mattan0290c-22" target="_blank" class="btn btn-amazon">üõí Amazon</a>
                                        <div class="btn btn-outline" onclick="document.getElementById('card-${idx}').classList.toggle('flipped')">üîÑ AI_VIBE</div>
                                    </div>
                                </div>
                                <div class="back">
                                    <div class="ai-image-wrap"><img src="${t.aiImage}" onerror="this.src='https://placehold.jp/24/ff8fc5/ffffff/800x450.png?text=VIBE_IMAGE...'"></div>
                                    <div class="summary-box">
                                        <div class="summary-label">AI_INSIGHT_SUMMARY</div>
                                        <div class="summary-text">${t.aiSummary}</div>
                                    </div>
                                    <div class="btn-group">
                                        <div class="btn btn-dark" onclick="document.getElementById('card-${idx}').classList.toggle('flipped')">üîô Êàª„Çã</div>
                                    </div>
                                </div>
                            </div>
                        </div>`;
                }).join('');
            } catch (e) { console.error(e); }
        }
        window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });
        load();
    </script>
</body>
</html>